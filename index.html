<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Omega Zero – وضع المحاكاة</title>
  <style>
    body { background: #121212; color: #eee; font-family: Arial, sans-serif; text-align:center; margin:0; padding:20px; }
    .card { border:1px solid #444; background:#1c1c1c; padding:15px; margin:20px auto; max-width:400px; border-radius:8px; }
    .btn { background:#444; color:#fff; border:none; padding:10px 20px; margin:5px; border-radius:5px; cursor:pointer; }
    .btn:hover { background:#666; }
    .log { background:#111; color:#0f0; height:200px; overflow:auto; padding:10px; font-size:13px; text-align:left; }
  </style>
</head>
<body>

  <h1>Omega Zero – وضع المحاكاة</h1>
  <div class="card">
    <p>💠 الحالة: <span id="status">بانتظار بدء المحاكاة...</span></p>
    <p>📊 عدد الصفقات: <span id="trades">0</span></p>
    <p>💵 الأرباح الكلية: <span id="profit">0</span> $</p>
    <p>🔥 السرعة: <span id="speed">100</span></p>
    <div>
      <button class="btn" onclick="connect()">اتصال</button>
      <button class="btn" onclick="startSim()">بدء</button>
      <button class="btn" onclick="stopSim()">إيقاف</button>
      <button class="btn" onclick="resetSim()">إعادة</button>
    </div>
    <div class="log" id="log">📥 سجل المحاكاة جاهز...</div>
  </div>

  <script>
    let connected = false, running = false, trades = 0, profit = 0;
    const logEl = document.getElementById('log');

    const priceData = [198.80, 198.92, 199.12, 198.65, 199.30, 199.10, 198.95, 199.50, 198.40]; // بيانات يوم 21-7-2025

    function connect() {
      connected = true;
      document.getElementById('status').innerText = "✅ تم الاتصال بالمحاكاة";
      appendLog("✅ النظام متصل وجاهز.");
    }

    function startSim() {
      if (!connected) {
        appendLog("⚠️ يجب الاتصال أولاً قبل البدء.");
        return;
      }
      if (running) return;
      running = true;
      appendLog("▶️ بدء تشغيل المحاكاة...");
      simulate();
    }

    function stopSim() {
      if (!running) return;
      running = false;
      appendLog("⏸️ تم إيقاف المحاكاة.");
    }

    function resetSim() {
      running = false;
      trades = 0; profit = 0;
      document.getElementById('trades').innerText = trades;
      document.getElementById('profit').innerText = profit;
      appendLog("🔄 تمت إعادة المحاكاة.");
    }

    async function simulate() {
      for (let price of priceData) {
        if (!running) break;
        await new Promise(r => setTimeout(r, 1000)); // الانتظار ثانية بين كل خطوة
        let tradeProfit = (Math.random() * 50 - 25).toFixed(2);
        profit += parseFloat(tradeProfit);
        trades += 1;
        document.getElementById('trades').innerText = trades;
        document.getElementById('profit').innerText = profit.toFixed(2);
        appendLog(`📈 صفقة جديدة عند السعر ${price} | ربح: ${tradeProfit}$`);
      }
      if (running) appendLog("✅ انتهت محاكاة اليوم بالكامل.");
      running = false;
    }

    function appendLog(text) {
      logEl.innerHTML += text + "<br>";
      logEl.scrollTop = logEl.scrollHeight;
    }
  </script>
</body>
</html>
